# Composable Quality Metrics for Robot Behavior Chains
### Based on Lyapunov Exponents and Fractal Dimensions

## Problem

로봇 행동 체인(걷기 → 집기 → 놓기)에서:
- 각 행동은 개별 최적화 가능 (MPC, RRT*)
- 그러나 **체인 전체의 성공 가능성**은 실행 전에 예측할 수 없다
- 체인이 길어질수록 불안정이 어떻게 전파되는지에 대한 **합성 규칙이 없다**

## Proposed: 합성 가능한 품질 메트릭

카오스 이론의 두 지표를 행동 품질에 대입:

```
Ω (안정성) = 1 / (1 + max(λ, 0))     ← Lyapunov 지수
Φ (정밀도) = 1 / (1 + D / D_max)      ← 프랙탈 차원
```

**핵심은 이 지표가 합성 규칙을 가진다는 것:**

```
직렬 (A → B):   λ_total = λ_A + λ_B        불안정이 누적됨
                Φ_total = Φ_A × Φ_B        정밀도가 곱셈으로 열화됨

병렬 (A ∥ B):   λ_total = max(λ_A, λ_B)    최약 고리가 지배함
                Φ_total = min(Φ_A, Φ_B)    최약 고리가 지배함
```

→ 행동 체인 전체의 품질을 **실행 없이 해석적으로 계산 가능**

## Example

```
임무: 테이블 위 물건 → 선반 배치

A: 보행 (λ=0.18)  →  B: 파지 (λ=0.11)  →  C: 보행 (λ=0.18)  →  D: 배치 (λ=0.11)

직렬 합성:
  λ_total = 0.18 + 0.11 + 0.18 + 0.11 = 0.58
  Ω_total = 1/(1+0.58) = 0.633  →  상당히 불안정
  Φ_total = 0.8 × 0.95 × 0.8 × 0.9 = 0.547  →  최종 정밀도 낮음

대안 (B를 A와 병렬화: 걸으면서 팔 준비):
  λ_A∥B = max(0.18, 0.11) = 0.18  (합산 0.29 대비 개선)
  → 전체 Ω 상승, Φ 상승

→ 합성 규칙이 "어떻게 조합해야 품질이 올라가는지"를 알려줌
```

## Why Not Just Precomputation?

이건 "미리 계산해서 저장" 하자는 제안이 아님:

| 관점 | 룩업 테이블 / 캐시 | 이 프레임워크 |
|------|-------------------|-------------|
| A+B 조합 품질 | 모름 (실행해봐야 앎) | **해석적으로 계산 가능** |
| 실패 시 | 조용히 실패 | **왜 실패하는지 설명** (λ가 높은 경로 특정) |
| 불가능한 목표 | 타임아웃까지 시도 | **사전 감지** (아트랙터 차원 → D_max이면 안정해 없음) |
| 정밀도 수준 | 이진 (맞/틀) | **연속 스펙트럼** (Ω=0.85는 Ω=0.5보다 얼마나 더 안정한지 정량화) |

**기여는 실행 모델이 아니라 합성 규칙과 품질 메트릭.**

## What Exists

| 항목 | 상태 |
|------|------|
| Ω/Φ 수학적 정의 + 합성 규칙 증명 | ✅ |
| Lyapunov 추정 (Benettin QR, 평균 오차 0.0002) | ✅ |
| 프랙탈 차원 추정 (Box-counting, Grassberger-Procaccia) | ✅ |
| Python 구현 (품질 메트릭 계산 파이프라인) | ✅ |
| Rust + GPU 구현 (O(n) 근사 정렬 — 별도 응용) | ✅ |
| **로봇 행동 데이터에서의 검증** | ❌ 미수행 |

## Questions

1. Atlas에서 **행동 체인의 누적 불안정**이 실제 문제인가?
   긴 체인에서 앞선 행동의 오차가 뒤에 전파되는 걸 경험하는가?

2. 보행/조작 데이터에서 **Lyapunov 지수를 추정해 본 적이 있는가?**
   보행 아트랙터의 λ 값이 알려져 있는가?

3. "직렬 합성 시 λ가 합산된다"는 규칙이 **직관적으로 맞는가?**
   아니면 실제로는 다른 전파 패턴이 관찰되는가?

## Links

- Repository: [AXOL GitHub] *(링크 삽입)*
- Theory: `THEORY.md`, `THEORY_MATH.md`
- GPU Benchmark: `axol-lang/src/bin/bench_gpu_sort.rs`
